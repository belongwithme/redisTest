# RabbitMQ 环境准备指南

## 一、Docker 方式安装 RabbitMQ（推荐）

### 方式一：使用 Docker 命令直接启动

```bash
# 拉取 RabbitMQ 镜像（包含管理界面）
docker pull rabbitmq:3-management

# 启动 RabbitMQ 容器
docker run -d --name rabbitmq \
  -p 5672:5672 \
  -p 15672:15672 \
  -e RABBITMQ_DEFAULT_USER=admin \
  -e RABBITMQ_DEFAULT_PASS=admin123 \
  rabbitmq:3-management

# 查看容器状态
docker ps | grep rabbitmq

# 查看容器日志
docker logs rabbitmq
```

### 方式二：使用 docker-compose（推荐）

创建 `docker-compose.yml` 文件，然后使用 docker-compose 启动：

```bash
# 启动服务
docker-compose up -d

# 查看服务状态
docker-compose ps

# 停止服务
docker-compose down

# 查看日志
docker-compose logs rabbitmq
```

### 端口说明
- **5672**: AMQP 协议端口（应用连接使用）
- **15672**: Web 管理界面端口（浏览器访问）

### 默认账户信息
- **用户名**: admin
- **密码**: admin123
- **管理界面**: http://localhost:15672

## 二、验证 RabbitMQ 安装

### 1. 检查容器运行状态
```bash
docker ps
```
应该看到类似输出：
```
CONTAINER ID   IMAGE                   COMMAND                  CREATED         STATUS         PORTS                                                                                                         NAMES
abc123def456   rabbitmq:3-management   "docker-entrypoint.s…"   2 minutes ago   Up 2 minutes   4369/tcp, 5671/tcp, 0.0.0.0:5672->5672/tcp, 15671/tcp, 25672/tcp, 0.0.0.0:15672->15672/tcp             rabbitmq
```

### 2. 访问管理界面
打开浏览器访问：http://localhost:15672
- 输入用户名：`admin`
- 输入密码：`admin123`

成功登录后，您应该看到 RabbitMQ 的管理控制台。

### 3. 检查连接
```bash
# 进入容器
docker exec -it rabbitmq bash

# 查看状态
rabbitmqctl status

# 查看用户列表
rabbitmqctl list_users

# 退出容器
exit
```

## 三、本地安装方式（备选）

### Windows 安装
1. 下载 Erlang: https://www.erlang.org/downloads
2. 下载 RabbitMQ: https://www.rabbitmq.com/download.html
3. 安装 Erlang，然后安装 RabbitMQ
4. 启用管理插件：
   ```cmd
   rabbitmq-plugins enable rabbitmq_management
   ```

### macOS 安装
```bash
# 使用 Homebrew
brew install rabbitmq

# 启动服务
brew services start rabbitmq

# 启用管理插件
rabbitmq-plugins enable rabbitmq_management
```

### Linux 安装
```bash
# Ubuntu/Debian
sudo apt-get update
sudo apt-get install rabbitmq-server

# CentOS/RHEL
sudo yum install rabbitmq-server
# 或者使用 dnf
sudo dnf install rabbitmq-server

# 启动服务
sudo systemctl start rabbitmq-server
sudo systemctl enable rabbitmq-server

# 启用管理插件
sudo rabbitmq-plugins enable rabbitmq_management
```

## 四、常见问题解决

### 问题1：端口被占用
```bash
# 查看端口占用情况
netstat -tulpn | grep :5672
netstat -tulpn | grep :15672

# Windows 查看端口
netstat -ano | findstr :5672
```

解决方案：
- 修改 docker-compose.yml 中的端口映射
- 或者停止占用端口的其他服务

### 问题2：容器启动失败
```bash
# 查看详细错误日志
docker logs rabbitmq

# 重新启动容器
docker restart rabbitmq
```

### 问题3：无法访问管理界面
1. 确认容器正在运行
2. 检查防火墙设置
3. 确认端口映射正确

### 问题4：权限问题
```bash
# 创建用户和设置权限
docker exec rabbitmq rabbitmqctl add_user admin admin123
docker exec rabbitmq rabbitmqctl set_user_tags admin administrator
docker exec rabbitmq rabbitmqctl set_permissions -p / admin ".*" ".*" ".*"
```

## 五、生产环境注意事项

### 安全配置
1. 修改默认用户名和密码
2. 配置 SSL/TLS 加密
3. 限制管理界面访问 IP
4. 设置合适的内存和磁盘限制

### 性能优化
1. 调整内存限制参数
2. 配置集群模式
3. 设置合适的预取数量
4. 监控队列长度和消息堆积

### 监控和日志
1. 配置日志轮转
2. 设置监控告警
3. 备份配置文件
4. 定期检查集群状态

---

**下一步**: 完成环境准备后，继续 SpringBoot 项目配置和代码开发。