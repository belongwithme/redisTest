<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Javaå¼€å‘è€…ç²¾é€šElasticsearchå­¦ä¹ è·¯çº¿</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f0f4f8;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }
        .gradient-text {
            background: linear-gradient(to right, #096DD9, #40A9FF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .step-item {
            position: relative;
            padding: 1rem 1.5rem 1rem 3rem;
            background-color: white;
            border-left: 4px solid #91D5FF;
            transition: all 0.3s ease;
        }
        .step-item:not(:last-child) {
            margin-bottom: 1.5rem;
        }
        .step-item:hover {
            border-left-color: #1890FF;
            transform: translateX(5px);
        }
        .step-item::before {
            content: attr(data-step);
            position: absolute;
            left: -20px;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #40A9FF;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="text-center my-8 md:my-16">
            <h1 class="text-4xl md:text-6xl font-bold gradient-text">Javaå¼€å‘è€…ç²¾é€šElasticsearch</h1>
            <p class="text-lg md:text-xl text-gray-600 mt-4 max-w-3xl mx-auto">ä¸€ä»½ä»å…¥é—¨åˆ°ç²¾é€šçš„å•é¡µå­¦ä¹ è·¯çº¿å›¾ï¼ŒåŠ©ä½ è§£é”å…¨æ–‡æœç´¢ä¸å¤§æ•°æ®åˆ†æçš„å¼ºå¤§èƒ½åŠ›ã€‚</p>
        </header>

        <main class="space-y-16">

            <section id="foundation">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">ç¬¬ä¸€éƒ¨åˆ†ï¼šå¥ å®šåŸºç¡€</h2>
                    <p class="text-gray-600 mt-2">ç†è§£Elasticsearchçš„â€œæ˜¯ä»€ä¹ˆâ€ä¸â€œä¸ºä»€ä¹ˆâ€ï¼Œä»¥åŠå®ƒçš„æ ¸å¿ƒæ¶æ„ã€‚</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-stretch">
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold mb-4 text-center text-[#096DD9]">ES vs. å…³ç³»å‹æ•°æ®åº“ (MySQL)</h3>
                        <p class="text-sm text-gray-600 mb-4">ESå¹¶éè¦å–ä»£MySQLï¼Œè€Œæ˜¯åŠŸèƒ½äº’è¡¥ã€‚åœ¨ç°ä»£æ¶æ„ä¸­ï¼Œå®ƒä»¬å¸¸å¸¸ååŒå·¥ä½œï¼ŒMySQLä½œä¸ºè®°å½•ç³»ç»Ÿ(SoR)ï¼ŒESä½œä¸ºæœç´¢ä¸åˆ†æç³»ç»Ÿã€‚</p>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left">
                                <thead class="bg-[#E6F7FF] text-[#096DD9]">
                                    <tr>
                                        <th class="p-2 rounded-tl-md">ç‰¹æ€§</th>
                                        <th class="p-2">Elasticsearch</th>
                                        <th class="p-2 rounded-tr-md">MySQL</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="border-b"><td class="p-2 font-semibold">æ ¸å¿ƒä¼˜åŠ¿</td><td class="p-2">å…¨æ–‡æœç´¢, å®æ—¶åˆ†æ</td><td class="p-2">äº‹åŠ¡, æ•°æ®ä¸€è‡´æ€§</td></tr>
                                    <tr class="border-b"><td class="p-2 font-semibold">æ•°æ®ç»“æ„</td><td class="p-2">JSONæ–‡æ¡£ (éç»“æ„åŒ–)</td><td class="p-2">è¡¨/è¡Œ/åˆ— (ç»“æ„åŒ–)</td></tr>
                                    <tr class="border-b"><td class="p-2 font-semibold">æŸ¥è¯¢è¯­è¨€</td><td class="p-2">Query DSL (JSON)</td><td class="p-2">SQL</td></tr>
                                    <tr><td class="p-2 font-semibold">æ‰©å±•æ€§</td><td class="p-2">æ°´å¹³æ‰©å±• (å¤©ç”Ÿ)</td><td class="p-2">å‚ç›´æ‰©å±• (ä¸ºä¸»)</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-lg flex flex-col justify-center">
                        <h3 class="text-xl font-bold mb-4 text-center text-[#096DD9]">æ ¸å¿ƒæ¶æ„æ¦‚å¿µ</h3>
                        <div class="space-y-3 text-center">
                            <div class="p-3 bg-[#BAE7FF] rounded-lg border-2 border-[#91D5FF]">
                                <p class="font-bold text-lg text-[#096DD9]">é›†ç¾¤ (Cluster)</p>
                                <p class="text-sm text-gray-700">ä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹çš„é›†åˆ</p>
                                <div class="mt-3 p-3 bg-[#E6F7FF] rounded-lg border-2 border-[#BAE7FF]">
                                    <p class="font-bold text-md text-[#096DD9]">èŠ‚ç‚¹ (Node)</p>
                                    <p class="text-sm text-gray-700">ä¸€ä¸ªESå®ä¾‹</p>
                                    <div class="mt-3 p-3 bg-white rounded-lg border-2 border-[#E6F7FF]">
                                        <p class="font-bold text-md text-[#096DD9]">ç´¢å¼• (Index)</p>
                                        <p class="text-sm text-gray-700">ç›¸ä¼¼æ–‡æ¡£çš„é›†åˆ (ç±»ä¼¼æ•°æ®åº“)</p>
                                        <div class="grid grid-cols-2 gap-2 mt-2">
                                           <div class="p-2 bg-gray-50 rounded">
                                               <p class="font-semibold text-sm">åˆ†ç‰‡ (Shard)</p>
                                               <p class="text-xs">ç´¢å¼•çš„æ°´å¹³åˆ†åŒº</p>
                                           </div>
                                            <div class="p-2 bg-gray-50 rounded">
                                               <p class="font-semibold text-sm">å‰¯æœ¬ (Replica)</p>
                                               <p class="text-xs">åˆ†ç‰‡çš„æ‹·è´</p>
                                           </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="getting-started">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">ç¬¬äºŒéƒ¨åˆ†ï¼šå…¥é—¨å®è·µ</h2>
                    <p class="text-gray-600 mt-2">ä½¿ç”¨Dockerå¿«é€Ÿæ­å»ºä½ çš„ç¬¬ä¸€ä¸ªæœ¬åœ°å¼€å‘ç¯å¢ƒã€‚</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold mb-6 text-center text-[#096DD9]">æœ¬åœ°ç¯å¢ƒéƒ¨ç½²æµç¨‹</h3>
                    <div class="flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0 md:space-x-4">
                        <div class="text-center p-4 rounded-lg flex-1">
                            <div class="text-4xl mb-2">1ï¸âƒ£</div>
                            <h4 class="font-bold">å®‰è£… Docker</h4>
                            <p class="text-sm text-gray-600">ç°ä»£åŒ–å¼€å‘çš„åŸºç¡€</p>
                        </div>
                        <div class="text-2xl text-[#91D5FF] font-light hidden md:block">â†’</div>
                        <div class="text-center p-4 rounded-lg flex-1">
                            <div class="text-4xl mb-2">2ï¸âƒ£</div>
                            <h4 class="font-bold">é…ç½®ç³»ç»Ÿ</h4>
                            <p class="text-sm text-gray-600">è®¾ç½® vm.max_map_count</p>
                        </div>
                        <div class="text-2xl text-[#91D5FF] font-light hidden md:block">â†’</div>
                        <div class="text-center p-4 rounded-lg flex-1">
                            <div class="text-4xl mb-2">3ï¸âƒ£</div>
                            <h4 class="font-bold">è¿è¡Œ ES å®¹å™¨</h4>
                            <p class="text-sm text-gray-600">å¯åŠ¨æ ¸å¿ƒæœåŠ¡</p>
                        </div>
                         <div class="text-2xl text-[#91D5FF] font-light hidden md:block">â†’</div>
                        <div class="text-center p-4 rounded-lg flex-1">
                            <div class="text-4xl mb-2">4ï¸âƒ£</div>
                            <h4 class="font-bold">è¿è¡Œ Kibana</h4>
                            <p class="text-sm text-gray-600">ä½ çš„å¯è§†åŒ–ç®¡ç†åå°</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="query-dsl">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">ç¬¬ä¸‰ & å››éƒ¨åˆ†ï¼šæœç´¢çš„è‰ºæœ¯</h2>
                    <p class="text-gray-600 mt-2">æŒæ¡ä¸ESäº¤äº’çš„è¯­è¨€ï¼šREST APIä¸Query DSLã€‚</p>
                </div>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold mb-4 text-center text-[#096DD9]">æŸ¥è¯¢ä¸Šä¸‹æ–‡ vs è¿‡æ»¤ä¸Šä¸‹æ–‡</h3>
                        <p class="text-sm text-gray-600 mb-4">è¿™æ˜¯Query DSLæ€§èƒ½å’Œç›¸å…³æ€§è°ƒä¼˜çš„æ ¸å¿ƒã€‚`must/should`å…³å¿ƒâ€œåŒ¹é…å¤šå¥½â€ï¼Œè®¡ç®—å¾—åˆ†ï¼›`filter/must_not`åªå…³å¿ƒâ€œæ˜¯å¦åŒ¹é…â€ï¼Œä¸è®¡ç®—å¾—åˆ†ï¼Œé€Ÿåº¦å¿«ä¸”å¯ç¼“å­˜ã€‚</p>
                        <div class="chart-container">
                            <canvas id="contextChart"></canvas>
                        </div>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold mb-4 text-center text-[#096DD9]">`bool`æŸ¥è¯¢ï¼šä¸‡èƒ½ç»„åˆå™¨</h3>
                        <p class="text-sm text-gray-600 mb-4">`bool`æŸ¥è¯¢è®©ä½ ç»„åˆå¤šä¸ªå­æŸ¥è¯¢ã€‚æœ€ä½³å®è·µæ˜¯å°†å½±å“ç›¸å…³æ€§çš„æ¡ä»¶æ”¾`must`ï¼Œå°†èµ·ç­›é€‰ä½œç”¨çš„æ¡ä»¶æ”¾`filter`ã€‚</p>
                        <div class="bg-gray-800 text-white p-4 rounded-md font-mono text-xs overflow-x-auto">
<pre><code>POST /products/_search
{
  "query": {
    "bool": {
      <span class="text-yellow-400">"must"</span>: [
        { "match": { "name": "laptop" } }
      ],
      <span class="text-green-400">"filter"</span>: [
        { "term":  { "brand.keyword": "TechCorp" } },
        { "range": { "price": { "lte": 1500 } } }
      ]
    }
  }
}
</code></pre>
                        </div>
                         <div class="mt-4 space-y-2 text-sm">
                            <p><strong class="text-yellow-600">must (æŸ¥è¯¢ä¸Šä¸‹æ–‡):</strong> å¿…é¡»åŒ¹é…ï¼Œè®¡ç®—ç›¸å…³æ€§å¾—åˆ†ã€‚å›ç­”â€œå¤šç›¸å…³ï¼Ÿâ€</p>
                            <p><strong class="text-green-600">filter (è¿‡æ»¤ä¸Šä¸‹æ–‡):</strong> å¿…é¡»åŒ¹é…ï¼Œä¸è®¡ç®—å¾—åˆ†ï¼Œå¯ç¼“å­˜ã€‚å›ç­”â€œæ˜¯å¦åŒ¹é…ï¼Ÿâ€</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="analysis-mapping">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">ç¬¬äº”éƒ¨åˆ†ï¼šæ·±å…¥åº•å±‚</h2>
                    <p class="text-gray-600 mt-2">ç†è§£æ–‡æœ¬åˆ†æä¸æ•°æ®æ˜ å°„å¦‚ä½•å·¥ä½œã€‚</p>
                </div>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold mb-4 text-center text-[#096DD9]">æ–‡æœ¬åˆ†ææµç¨‹</h3>
                        <p class="text-sm text-gray-600 mb-6">æ–‡æœ¬åˆ†ææ˜¯å°†éç»“æ„åŒ–æ–‡æœ¬è½¬æ¢ä¸ºå¯æœç´¢çš„ã€æ ‡å‡†åŒ–çš„è¯æ¡ï¼ˆTokenï¼‰çš„è¿‡ç¨‹ã€‚</p>
                        <div class="flex items-center justify-around text-center">
                            <div class="w-1/4">
                                <p class="font-bold">å­—ç¬¦è¿‡æ»¤å™¨</p>
                                <p class="text-xs">å¦‚å»é™¤HTMLæ ‡ç­¾</p>
                            </div>
                            <div class="text-2xl text-[#91D5FF] font-light">â†’</div>
                             <div class="w-1/4">
                                <p class="font-bold text-[#096DD9]">åˆ†è¯å™¨</p>
                                <p class="text-xs">å°†æ–‡æœ¬æ‹†åˆ†æˆè¯æ¡</p>
                            </div>
                            <div class="text-2xl text-[#91D5FF] font-light">â†’</div>
                             <div class="w-1/4">
                                <p class="font-bold">è¯æ¡è¿‡æ»¤å™¨</p>
                                <p class="text-xs">å¦‚è½¬å°å†™ã€å»åœç”¨è¯</p>
                            </div>
                        </div>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-lg">
                        <h3 class="text-xl font-bold mb-4 text-center text-[#096DD9]">æ ¸å¿ƒæ•°æ®ç±»å‹: `text` vs `keyword`</h3>
                        <p class="text-sm text-gray-600 mb-4">å¯¹äºå­—ç¬¦ä¸²å­—æ®µï¼Œ`text`ç”¨äºå…¨æ–‡æœç´¢ï¼ˆä¼šè¢«åˆ†æï¼‰ï¼Œ`keyword`ç”¨äºç²¾ç¡®åŒ¹é…ã€æ’åºå’Œèšåˆï¼ˆä¸è¢«åˆ†æï¼‰ã€‚ä½¿ç”¨`multi-fields`å¯ä»¥å…¼å¾—ä¸¤è€…ä¼˜åŠ¿ã€‚</p>
                        <div class="chart-container">
                            <canvas id="typeChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <section id="aggregations">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">ç¬¬å…­éƒ¨åˆ†ï¼šè¶…è¶Šæœç´¢</h2>
                    <p class="text-gray-600 mt-2">ä½¿ç”¨èšåˆ(Aggregations)è¿›è¡Œå¼ºå¤§çš„æ•°æ®åˆ†æã€‚</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold mb-4 text-center text-[#096DD9]">èšåˆå®æˆ˜ï¼šåˆ†æå„å“ç‰Œå•†å“å¹³å‡ä»·æ ¼</h3>
                    <p class="text-sm text-gray-600 mb-4 text-center max-w-2xl mx-auto">èšåˆçš„å¨åŠ›åœ¨äºåµŒå¥—ã€‚ä»¥ä¸‹å›¾è¡¨é€šè¿‡å¤–å±‚çš„<strong class="text-[#096DD9]">æ¡¶èšåˆ</strong>ï¼ˆ`terms`æŒ‰å“ç‰Œåˆ†ç»„ï¼‰å’Œå†…å±‚çš„<strong class="text-[#40A9FF]">æŒ‡æ ‡èšåˆ</strong>ï¼ˆ`avg`è®¡ç®—å¹³å‡ä»·æ ¼ï¼‰ï¼Œç›´è§‚å±•ç¤ºäº†åˆ†æç»“æœã€‚</p>
                    <div class="chart-container">
                        <canvas id="aggChart"></canvas>
                    </div>
                </div>
            </section>

            <section id="java-integration">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">ç¬¬ä¸ƒéƒ¨åˆ†ï¼šJavaå¼€å‘è€…çš„åˆ©å™¨</h2>
                    <p class="text-gray-600 mt-2">ä½¿ç”¨Spring Data Elasticsearchæä¾›çš„â€œæŠ½è±¡é˜¶æ¢¯â€ç®€åŒ–å¼€å‘ã€‚</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold mb-6 text-center text-[#096DD9]">Spring DataæŸ¥è¯¢æŠ½è±¡é˜¶æ¢¯</h3>
                    <div class="w-full max-w-2xl mx-auto">
                        <div class="step-item" data-step="1">
                            <h4 class="font-bold text-lg">æ´¾ç”ŸæŸ¥è¯¢ (Derived Queries)</h4>
                            <p class="text-sm text-gray-600">æœ€ç®€å•ã€‚æ ¹æ®æ–¹æ³•åè‡ªåŠ¨ç”ŸæˆæŸ¥è¯¢ï¼Œé€‚ç”¨äºç®€å•æŸ¥æ‰¾ã€‚</p>
                            <p class="font-mono text-xs mt-1 bg-gray-100 p-1 rounded">`List<Product> findByBrand(String brand);`</p>
                        </div>
                        <div class="step-item" data-step="2">
                            <h4 class="font-bold text-lg">`@Query` æ³¨è§£</h4>
                            <p class="text-sm text-gray-600">æ›´çµæ´»ã€‚ç›´æ¥ç¼–å†™JSONæ ¼å¼çš„Query DSLã€‚</p>
                             <p class="font-mono text-xs mt-1 bg-gray-100 p-1 rounded">`@Query("{\"match\": {\"name\": \"?0\"}}")`</p>
                        </div>
                        <div class="step-item" data-step="3">
                            <h4 class="font-bold text-lg">ElasticsearchOperations</h4>
                            <p class="text-sm text-gray-600">ç»ˆææ§åˆ¶ã€‚ä»¥ç¼–ç¨‹æ–¹å¼æ„å»ºä»»ä½•å¤æ‚æŸ¥è¯¢å’Œèšåˆã€‚</p>
                             <p class="font-mono text-xs mt-1 bg-gray-100 p-1 rounded">`elasticsearchOperations.search(query, ...)`</p>
                        </div>
                    </div>
                     <p class="text-center mt-6 text-gray-600">æ ¹æ®ä»»åŠ¡å¤æ‚æ€§ï¼Œé€‰æ‹©æœ€åˆé€‚çš„é˜¶æ¢¯ï¼Œåœ¨å¼€å‘æ•ˆç‡å’Œçµæ´»æ€§ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚</p>
                </div>
            </section>

            <section id="learning">
                <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-gray-800">ç¬¬å…«éƒ¨åˆ†ï¼šç²¾é€šä¹‹è·¯</h2>
                    <p class="text-gray-600 mt-2">æŒç»­å­¦ä¹ ï¼Œä¿æŒæˆé•¿ã€‚</p>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 text-center">
                    <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow">
                        <div class="text-4xl mb-3">ğŸ“š</div>
                        <h4 class="font-bold text-lg">å®˜æ–¹æ–‡æ¡£</h4>
                        <p class="text-sm text-gray-600">æœ€æƒå¨ã€æœ€å‡†ç¡®çš„ä¿¡æ¯æ¥æºã€‚</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow">
                        <div class="text-4xl mb-3">ğŸ“</div>
                        <h4 class="font-bold text-lg">å®˜æ–¹åšå®¢</h4>
                        <p class="text-sm text-gray-600">è·å–æœ€æ–°åŠŸèƒ½å’Œæœ€ä½³å®è·µã€‚</p>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow">
                         <div class="text-4xl mb-3">ğŸ’¬</div>
                        <h4 class="font-bold text-lg">ç¤¾åŒºè®ºå›</h4>
                        <p class="text-sm text-gray-600">ä¸å…¨çƒå¼€å‘è€…äº¤æµé—®é¢˜ã€‚</p>
                    </div>
                     <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-xl transition-shadow">
                         <div class="text-4xl mb-3">ğŸ†</div>
                        <h4 class="font-bold text-lg">åŸ¹è®­ä¸è®¤è¯</h4>
                        <p class="text-sm text-gray-600">éªŒè¯å¹¶å±•ç¤ºä½ çš„ä¸“ä¸šèƒ½åŠ›ã€‚</p>
                    </div>
                </div>
            </section>
        </main>

        <footer class="text-center mt-16 py-6 border-t">
            <p class="text-gray-500">ä¿¡æ¯å›¾æ ¹æ®æä¾›çš„å­¦ä¹ è·¯çº¿ç”Ÿæˆ | ç¥ä½ å­¦ä¹ æ„‰å¿«ï¼</p>
        </footer>
    </div>

<script>
// Ocean Breeze Color Palette
const colors = {
    primary: '#1890FF',
    secondary: '#40A9FF',
    light: '#91D5FF',
    lighter: '#BAE7FF',
    background: '#E6F7FF',
    text: '#096DD9'
};

const tooltipCallback = {
    plugins: {
        tooltip: {
            callbacks: {
                title: function(tooltipItems) {
                    const item = tooltipItems[0];
                    let label = item.chart.data.labels[item.dataIndex];
                    if (Array.isArray(label)) {
                      return label.join(' ');
                    } else {
                      return label;
                    }
                }
            }
        },
        legend: {
            position: 'top',
        },
    },
    maintainAspectRatio: false,
    responsive: true
};

function wrapLabel(str, maxWidth) {
    if (str.length <= maxWidth) {
        return str;
    }
    const words = str.split(' ');
    let lines = [];
    let currentLine = '';
    for (const word of words) {
        if ((currentLine + word).length > maxWidth && currentLine.length > 0) {
            lines.push(currentLine.trim());
            currentLine = word + ' ';
        } else {
            currentLine += word + ' ';
        }
    }
    lines.push(currentLine.trim());
    return lines;
}

// Chart 1: Query Context vs Filter Context
const ctxContext = document.getElementById('contextChart').getContext('2d');
new Chart(ctxContext, {
    type: 'bar',
    data: {
        labels: ['æ€§èƒ½/é€Ÿåº¦', 'ç›¸å…³æ€§å¾—åˆ†è®¡ç®—'],
        datasets: [{
            label: 'æŸ¥è¯¢ä¸Šä¸‹æ–‡ (must/should)',
            data: [60, 100],
            backgroundColor: colors.secondary,
            borderColor: colors.primary,
            borderWidth: 1
        }, {
            label: 'è¿‡æ»¤ä¸Šä¸‹æ–‡ (filter)',
            data: [100, 0],
            backgroundColor: colors.light,
            borderColor: colors.secondary,
            borderWidth: 1
        }]
    },
    options: { ...tooltipCallback,
        scales: {
            y: {
                beginAtZero: true,
                max: 110,
                ticks: {
                    callback: function(value) {
                        return value + '%'
                    }
                }
            }
        }
    }
});

// Chart 2: text vs keyword
const ctxType = document.getElementById('typeChart').getContext('2d');
new Chart(ctxType, {
    type: 'doughnut',
    data: {
        labels: ['Text (ç”¨äºå…¨æ–‡æœç´¢)', 'Keyword (ç”¨äºç²¾ç¡®åŒ¹é…ã€èšåˆã€æ’åº)'],
        datasets: [{
            label: 'å­—ç¬¦ä¸²å­—æ®µç”¨é€”',
            data: [55, 45],
            backgroundColor: [colors.secondary, colors.light],
            borderColor: [colors.primary, colors.secondary],
            hoverOffset: 4
        }]
    },
    options: { ...tooltipCallback }
});

// Chart 3: Aggregations
const ctxAgg = document.getElementById('aggChart').getContext('2d');
new Chart(ctxAgg, {
    type: 'bar',
    data: {
        labels: ['TechCorp', 'ClickMaster', 'GadgetPro', 'InnoTech', 'DataWave'].map(l => wrapLabel(l, 16)),
        datasets: [{
            label: 'å„å“ç‰Œå¹³å‡ä»·æ ¼ ($)',
            data: [1250, 65, 340, 980, 550],
            backgroundColor: [colors.secondary, colors.light, colors.secondary, colors.light, colors.secondary],
            borderColor: colors.primary,
            borderWidth: 1
        }]
    },
    options: { ...tooltipCallback,
        scales: {
            y: {
                beginAtZero: true,
                ticks: {
                     callback: function(value) {
                        return '$' + value;
                    }
                }
            }
        }
    }
});
</script>

</body>
</html>
